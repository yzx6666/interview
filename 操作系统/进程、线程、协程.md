# 进程、线程、协程

## 进程：程序是指令、数据及其组织形式的描述，而进程是程序运行实例，包括程序计数器、寄存器和变量的当前值。
## 线程：微进程，一个进程里更小粒度的执行单位。一个进程有多个线程并发执行任务
## 协程：协程是微线程，在子程序内部执行，可在子程序内部中断，转而执行别的子程序，在适当的时候再回来接着执行。

<br/>

## 线程与进程的区别：
1.  ### 一个线程从属于一个进程；一个进程可以包含多个线程。
2.  ### 一个线程挂掉，对应的进程挂掉；一个进程挂掉，不会影响其他进程。
3.  ### 进程是系统资源调度的最小单位；线程CPU调度的最小单位。
4.  ### 进程系统开销显著大于线程开销；线程需要的系统资源更少。
5.  ### 进程在执行时拥有独立的内存单元，多个线程共享进程的内存，如代码段、数据段、扩展段；但每个线程拥有自己的栈段和寄存器组。
6.  ### 进程切换时需要刷新TLB并获取新的地址空间，然后切换硬件上下文和内核栈，线程切换时只需要切换硬件上下文和内核栈。
7.  ### 通信方式不一样。
8.  ### 进程适应于多核、多机分布；线程适用于多核

<br/>

## 线程和协程的区别：
1.  ### 协程执行效率极高。协程直接操作栈基本没有内核切换的开销，所以上下文的切换非常快，切换开销比线程更小。
2.  ### 协程不需要多线程的锁机制，因为多个协程从属于一个线程，不存在同时写变量冲突，效率比线程高。
3.  ### 一个线程可以有多个协程。

<br/>

## 协程的轻量级在哪里体现？
1.  ### 协程调用跟切换比线程效率高：协程执行效率极高。协程不需要多线程的锁机制，可以不加锁的访问全局变量，所以上下文的切换非常快。
2.  ### 协程占用内存少：执行协程只需要极少的栈内存（大概是4～5KB），而默认情况下，线程栈的大小为1MB。
3.  ### 切换开销更少：协程直接操作栈基本没有内核切换的开销，所以切换开销比线程少。

<br/>

## 有了进程为什么还要线程？
### 进程在早期的多任务操作系统中是基本的执行单元。每次进程切换，都要先保存进程资源然后再恢复，这称为上下文切换。但是进程频繁切换将引起额外开销，从而严重影响系统的性能。为了减少进程切换的开销，人们把两个任务放到一个进程中，每个任务用一个更小粒度的执行单元来实现并发执行，这就是线程