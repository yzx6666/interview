# 进程线程中断切换的过程

## 上下文切换：是指内核在CPU上对进程或者线程进行切换

## 1.   进程上下文切换
1.  **保护被中断进程的处理器现场信息**
2.  **修改被中断进程的进程控制块有关信息，如进程状态等**
3.  **把被中断进程的进程控制块放入有关队列**
4.  **选择下一个占有处理器运行的进程**
5.  **根据被选中进程设置操作系统用到的地址转换和存储保护信息**
    1.  **切换页目录以使用新地址**
    2.  **切换内核栈和硬件上下文（内存、数据段、堆栈段）**
6.  **根据被选中的进程恢复处理器现场**

## 2.   线程上下文切换
1.  **保护被中断线程的处理器现场信息**
1.  **修改被中断线程的线程控制块有关信息，如线程状态等**
1.  **把被中断线程的线程控制块加入有关队列**
1.  **选择下一个占有处理器运行的线程**
1.  **根据被选中线程设置操作系统用到的存储保护信息**
    1.  **切换内核栈和硬件上下文（切换堆栈，以及各寄存器）**
2.  **根据被选中线程恢复处理器现场**